:root{
  --green-900:#064e3b;
  --green-800:#065f46;
  --green-700:#047857;
  --green-600:#059669;
  --green-500:#10b981;
  --green-400:#34d399;
  --green-300:#6ee7b7;
  --green-200:#a7f3d0;
  --green-100:#d1fae5;

  --ink-900:#0f172a;
  --ink-700:#334155;
  --ink-500:#64748b;
  --ink-300:#cbd5e1;
  --ink-100:#e2e8f0;
  --paper:#f8fafc;
  --panel:#ffffff;

  --ring: 0 0 0 3px rgba(16,185,129,0.35);
  --radius: 16px;
  --shadow: 0 10px 24px rgba(4,120,87,0.08);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  background:linear-gradient(180deg, var(--paper), #fff);
  color:var(--ink-900);
}

.app-header{
  position:sticky; top:0; z-index:10;
  display:flex; align-items:center; justify-content:space-between;
  padding:16px 24px;
  background:linear-gradient(180deg, #ffffff, var(--paper));
  border-bottom:1px solid var(--ink-100);
}
.brand{display:flex; gap:12px; align-items:center}
.logo{
  width:40px; height:40px; border-radius:12px;
  display:grid; place-items:center;
  background:linear-gradient(135deg, var(--green-600), var(--green-400));
  color:#fff; font-weight:800; box-shadow:var(--shadow);
}
h1{font-size:20px; margin:0; letter-spacing:0.2px}
.subtitle{margin:2px 0 0 0; color:var(--ink-500); font-size:12px}

.actions{display:flex; gap:8px; align-items:center}

.btn{
  border:1px solid var(--ink-100);
  background:#fff; color:var(--ink-900);
  padding:10px 14px; border-radius:12px; cursor:pointer;
  font-weight:600; transition:transform .05s ease, box-shadow .15s ease, border-color .15s ease;
}
.btn-ghost{background:#fff}
.btn-ghost:hover{border-color:var(--green-300)}
.btn-primary{
  background:linear-gradient(135deg, var(--green-600), var(--green-500));
  color:#fff; border:0; box-shadow:var(--shadow);
}
.btn-primary:hover{filter:brightness(1.04)}
.btn:active{transform:translateY(1px)}
.btn.small{padding:6px 10px; font-size:12px}

.layout{
  display:grid; grid-template-columns:320px 1fr; gap:20px;
  padding:20px; max-width:1400px; margin:0 auto;
}
.sidebar{display:flex; flex-direction:column; gap:20px}
.content{display:flex; flex-direction:column; gap:20px}

.panel{
  background:var(--panel); border:1px solid var(--ink-100); border-radius:var(--radius);
  box-shadow:var(--shadow); padding:16px;
}
.panel-title{display:flex; align-items:center; justify-content:space-between; margin-bottom:8px}
.panel-divider{
  height:1px; background:var(--ink-100); margin:14px 0;
}

.purpose-box{
  border:1px dashed var(--green-300); border-radius:12px; padding:12px;
  background:linear-gradient(180deg, #fff, var(--green-100));
  outline:none;
}
.purpose-box:focus{box-shadow:var(--ring); border-color:var(--green-400)}

.muted{color:var(--ink-500); line-height:1.5}

.lever{margin-bottom:14px}
.lever label{display:block; font-weight:600; margin-bottom:6px}
.lever input[type="range"]{width:100%}
.lever-value{font-size:12px; color:var(--ink-500); margin-top:4px}
.toggle{display:flex; align-items:center; gap:8px; margin-top:6px}

.principles{margin:10px 0 0 18px; padding:0}
.principles li{margin:6px 0}

.toolbar{
  display:flex; gap:12px; align-items:flex-end; flex-wrap:wrap;
}
.control{display:flex; flex-direction:column; gap:6px; min-width:160px}
.control-grow{flex:1}
label{font-size:12px; color:var(--ink-700); font-weight:600}
select,input[type="search"]{
  padding:10px 12px; border-radius:12px; border:1px solid var(--ink-100); background:#fff;
}
select:focus,input[type="search"]:focus{outline:none; box-shadow:var(--ring); border-color:var(--green-300)}

.kpis{
  display:grid; grid-template-columns:repeat(4,1fr); gap:12px;
}
.kpi-card{
  background:linear-gradient(180deg, #fff, var(--green-100));
  border:1px solid var(--green-200);
  border-radius:14px; padding:14px;
}
.kpi-label{font-size:12px; color:var(--ink-700); font-weight:700}
.kpi-value{font-size:28px; font-weight:800; color:var(--green-800); margin-top:6px}
.kpi-trend{font-size:12px; color:var(--ink-500); margin-top:6px}

.grid-2{display:grid; grid-template-columns:1fr 1fr; gap:20px}

.mini-legend{display:flex; gap:10px; align-items:center; color:var(--ink-500); font-size:12px}
.dot{
  width:10px; height:10px; border-radius:50%;
  background:linear-gradient(135deg, var(--green-500), var(--green-300));
  display:inline-block;
}
.badge{
  display:inline-block; padding:2px 8px; border-radius:999px;
  background:var(--green-600); color:#fff; font-weight:700; font-size:11px;
}
.badge-b{background:var(--ink-500)}

.heatmap{
  display:grid; gap:6px;
  grid-template-columns:repeat(7, 1fr);
  user-select:none;
}
.heat-cell{
  aspect-ratio:1 / 1; border-radius:10px;
  display:grid; place-items:center; font-size:12px; font-weight:700; color:#063019;
  border:1px solid rgba(0,0,0,0.04);
}
.heat-cell:hover{outline:3px solid rgba(16,185,129,0.25); cursor:pointer}

.loop-map{
  width:100%; height:auto; background:
    radial-gradient(600px 300px at 70% 30%, rgba(16,185,129,0.08), transparent 50%),
    radial-gradient(500px 300px at 30% 70%, rgba(16,185,129,0.08), transparent 50%);
  border-radius:12px; border:1px solid var(--ink-100);
}

.node{
  fill:url(#nodeGradient);
  stroke:var(--green-400); stroke-width:1.2;
  filter:drop-shadow(0 6px 14px rgba(4,120,87,0.18));
}
.node-label{font-size:12px; font-weight:700; fill:#063019}
.link{stroke:var(--green-600); stroke-width:2; fill:none; marker-end:url(#arrow)}
.link.balancing{stroke:var(--ink-500)}
.link.reinforcing{stroke:var(--green-700)}
.link-label{font-size:11px; fill:var(--ink-700); font-weight:700}

.tooltip{
  position:absolute; background:#fff; border:1px solid var(--ink-100);
  border-radius:10px; padding:8px 10px; font-size:12px; color:var(--ink-900);
  box-shadow:var(--shadow); transform:translate(-50%, -120%);
  pointer-events:none;
}

.insights{margin:10px 0 0 18px; padding:0}
.insights li{margin:8px 0; line-height:1.5}
.interventions li strong{color:var(--green-800)}

.app-footer{
  border-top:1px solid var(--ink-100);
  padding:14px 20px; color:var(--ink-500); display:flex; gap:10px; justify-content:center;
}
.sep{opacity:.4}

@media (max-width: 1100px){
  .layout{grid-template-columns:1fr}
  .sidebar{order:2}
}
@media (max-width: 800px){
  .kpis{grid-template-columns:1fr 1fr}
  .grid-2{grid-template-columns:1fr}
}
